{% extends "base.html" %}

{% block content %}
<div class="max-w-md mx-auto bg-white rounded-xl shadow-lg border border-orange-200 p-8 mt-8">
    <h2 class="text-3xl font-bold mb-8 text-center text-gray-800">Reset Password</h2>
    
    {% if error %}
    <div class="bg-red-50 border-l-4 border-red-400 text-red-700 px-4 py-3 rounded-r mb-6">
        {{ error }}
    </div>
    {% endif %}
    
    <form method="POST">
        <div class="mb-4">
            <label class="block text-gray-700 text-sm font-semibold mb-2">Your Name</label>
            <input type="text" name="name" required 
                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all">
        </div>
        
        <div class="mb-4">
            <label class="block text-gray-700 text-sm font-semibold mb-2">Phone Number</label>
            <input type="tel" name="phone" id="phone" required 
                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all">
        </div>
        
        <div class="mb-4">
            <label class="block text-gray-700 text-sm font-semibold mb-2">New Password</label>
            <div class="relative">
                <input type="password" name="new_password" id="new_password" required 
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all pr-12">
                <button type="button" onclick="togglePassword('new_password')" 
                        class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-600 hover:text-gray-800">
                    <span id="new_password-icon">üëÅÔ∏è</span>
                </button>
            </div>
        </div>
        
        <div class="mb-6">
            <label class="block text-gray-700 text-sm font-semibold mb-2">Confirm New Password</label>
            <div class="relative">
                <input type="password" name="confirm_password" id="confirm_password" required 
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all pr-12"
                       onkeyup="checkPasswordMatch()">
                <button type="button" onclick="togglePassword('confirm_password')" 
                        class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-600 hover:text-gray-800">
                    <span id="confirm_password-icon">üëÅÔ∏è</span>
                </button>
            </div>
            <div id="password-match-status" class="text-sm mt-1"></div>
        </div>
        
        <button type="submit" 
                class="w-full bg-gradient-to-r from-orange-500 to-red-500 text-white py-3 px-6 rounded-lg hover:from-orange-600 hover:to-red-600 transform hover:scale-105 transition-all duration-200 font-semibold shadow-lg">
            Reset Password
        </button>
        
        <p class="text-center mt-3 text-xs text-gray-600">
            Enter the name and phone number you used during registration.
        </p>
    </form>
    
    <p class="text-center mt-6 text-gray-600">
        Remember your password? <a href="/login" class="text-orange-600 hover:text-orange-700 font-semibold hover:underline transition-colors">Sign In</a>
    </p>
</div>

<script>
function togglePassword(fieldId) {
    const field = document.getElementById(fieldId);
    const icon = document.getElementById(fieldId + '-icon');
    
    if (field.type === 'password') {
        field.type = 'text';
        icon.textContent = 'üôà';
    } else {
        field.type = 'password';
        icon.textContent = 'üëÅÔ∏è';
    }
}
</script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/css/intlTelInput.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/intlTelInput.min.js"></script>

<script>
const phoneInput = document.querySelector("#phone");
const iti = window.intlTelInput(phoneInput, {
    initialCountry: "ke",
    preferredCountries: ["ke", "us", "gb", "tz", "ug"],
    utilsScript: "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js"
});

function checkPasswordMatch() {
    const password = document.getElementById('new_password').value;
    const confirmPassword = document.getElementById('confirm_password').value;
    const status = document.getElementById('password-match-status');
    
    if (confirmPassword.length === 0) {
        status.innerHTML = '';
        return;
    }
    
    if (password === confirmPassword) {
        status.innerHTML = '<span class="text-green-600">‚úì Passwords match</span>';
    } else {
        status.innerHTML = '<span class="text-red-600">‚úó Passwords do not match</span>';
    }
}
</script>
{% endblock %}